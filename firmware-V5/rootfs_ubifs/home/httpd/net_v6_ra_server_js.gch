<script language="javascript">
var RA_SERVER_PARA = new Array(
"MinWaitTime",
"MaxWaitTime",
"Mangment",
"OtherCfg"
);
function getmsg(id)
{
var str      = new Array();
str[0]   = new Array(101, "&?error_101;");
str[1]   = new Array(115, "&?error_115;");
str[2]   = new Array(116, "&?error_116;");
str[3]   = new Array(117, "&?error_117;");
str[4]   = new Array(201, "&?error_201;");
return getMsgFormArray(str, arguments);
}
function pageLoad(url)
{
getObj("fSubmit").action = url;
var errstr= getValue("IF_ERRORSTR");
var errpara = getValue("IF_ERRORPARAM");
OldProcessRet(errstr, errpara);
moveErrLayer(595,93);
pageGetValue();
}
function pageGetValue()
{
jslSetValue("Frm_MinWaitTime", "MinWaitTime");
jslSetValue("Frm_MaxWaitTime", "MaxWaitTime");
jslPostToViewCheckBox("Frm_Mangment", "Mangment");
jslPostToViewCheckBox("Frm_OtherCfg", "OtherCfg");
}
function pageCheckValue()
{
if( false == Check_IntegerRange(1, 3, 1350, "Frm_MinWaitTime", "Fnt_MinWaitTime"))
{
return false;
}
if( false == Check_IntegerRange(1, 4, 1800, "Frm_MaxWaitTime", "Fnt_MaxWaitTime"))
{
return false;
}
if(Number(getValue("Frm_MinWaitTime")) >= Number(getValue("Frm_MaxWaitTime")))
{
msg = getmsg(201);
ShowErrorForCom("Frm_MaxWaitTime", null, msg);
return false;
}
if(Number(getValue("Frm_MinWaitTime")) > (3/4)*Number(getValue("Frm_MaxWaitTime")))
{
msg = "&?v6_0061;";
ShowErrorForCom("Frm_MinWaitTime", null, msg);
return false;
}
return true;
}
function Check_IntegerRange(notNull, min, max, Frm, Fnt)
{
var value = getValue(Frm);
var tem = checkIntegerRange(value, min, max);
if( (tem == -1) && (notNull == 1) )
{
msg = getmsg(101);
ShowErrorForCom(Frm,Fnt,msg);
return false;
}
else if(tem == -2)
{
msg = getmsg(115);
ShowErrorForCom(Frm,Fnt,msg);
return false;
}
else if(tem == -3)
{
msg = getmsg(116,min,max);
ShowErrorForCom(Frm,Fnt,msg);
return false;
}
return true;
}
function pageSetValue()
{
HiddenParaInit(RA_SERVER_PARA);
jslSetValue("MinWaitTime", "Frm_MinWaitTime");
jslSetValue("MaxWaitTime", "Frm_MaxWaitTime");
jslViewToPostCheckBox("Mangment", "Frm_Mangment");
jslViewToPostCheckBox("OtherCfg", "Frm_OtherCfg");
}
function pageCancel()
{
DisableALL();
getObj("fSubmit").submit();
}
function pageSubmit()
{
if(true == pageCheckValue())
{
pageSetValue();
setValue("IF_ACTION", "apply");
DisableALL();
getObj("fSubmit").submit();
}
}
</script>
