
<script language="javascript" >
function getmsg(id)
{
var str  = new Array();
str[0]   = new Array(118, "&?error_118;");
str[1]   = new Array(102, "&?error_102;");
str[2]   = new Array(103, "&?error_103;");
str[3]   = new Array(104, "&?error_104;");
return getMsgFormArray(str, arguments);
}
function Check()
{
var value = getValue("Frm_DomainName");
if(checkStrLengthRange(value, 1, 64) != true)
{
msg = getmsg(102,1,64);
ShowErrorForCom("Frm_DomainName","Fnt_DomainName",msg);
return false;
}
if(checkDomainName(getValue("Frm_DomainName")) != true)
{
msg = getmsg(104);
ShowErrorForCom("Frm_DomainName","Fnt_DomainName",msg);
return false;
}
return true;
}
function myDiagStart()
{
if(Check() == true)
{
setValue("IF_ACTION", "set");
setValue("IF_DomainName", getValue("Frm_DomainName"));
DisableALL();
getObj("fSubmit").submit();
}
}
function UpdateResult(id)
{
var val = getValue("IF_"+id);
if(val == "pass")
{
document.getElementById(id).setAttribute("class", "green");
document.getElementById(id).setAttribute("className", "green");
}
else if(val == "fail")
{
document.getElementById(id).setAttribute("class", "red");
document.getElementById(id).setAttribute("className", "red");
}
else
{
document.getElementById(id).setAttribute("class", "");
document.getElementById(id).setAttribute("className", "");
}
}
function pageLoad(url)
{
getObj("fSubmit").action = url;
var domain_name = getValue("IF_DomainName");
if(domain_name != "NULL")
{
setValue("Frm_DomainName", domain_name);
}
if( getValue("IF_ERRORSTR") == "&?cmret_260;")
{
var errstr= getValue("IF_ERRORSTR");
var errpara = getValue("IF_ERRORPARAM");
OldProcessRet(errstr, errpara);
moveErrLayer(570,4);
}
else
{
UpdateResult("DiagResult");
}
}
</SCRIPT>
