<script language="javascript">
var APPLIST_PARA = new Array(
"ViewName",
"Enable",
"APPName",
"Catalog",
"Protocol",
"StartPort",
"EndPort",
"StartMapPort",
"EndMapPort"
);
var index = "";
var AppNum = 0;
var APP_PARA = new Array();
function pageLoad(url)
{
getObj("fSubmit").action = url;
var msg = "";
var errstr= getValue("IF_ERRORSTR");
var errpara = getValue("IF_ERRORPARAM");
OldProcessRet(errstr, errpara);
moveErrLayer(588,40);
pageGetValue();
}
function setIFName(i)
{
getObj("fSubmit").action = getURL("app_application_conf_t.gch", "vister", "app_application_list_conf_t.gch");
setValue("IF_APPName", APP_PARA[i]);
DisableALL();
getObj("fSubmit").submit();
}
function getNameValue(id, size, aid, value, num)
{
return ("<a id=\"" + aid + "\" onclick=\"setIFName(" + num + ")\" >"
+ "<input type=\"text\" class=\"uiNoBorder\" size=\"" + size +"\" value=\""
+ HTMLEnCode(value) + "\"  id=\"" + id + "\" style=\"cursor:pointer\"  readonly/></a>");
}
function getCheckBox(id, size, value)
{
if(value == 1)
{
return ("<input type=\"checkbox\"  class=\"uiNoBorder\" align=\"right\" name=\"checkbox\" id=\""+id+"\"  checked >");
}
else
{
return ("<input type=\"checkbox\"  class=\"uiNoBorder\" align=\"right\" id=\""+id+"\" >");
}
}
function addline(index)
{
var newline  = "";
var cellId = "";
var cellSize = 0;
var cellValue = "";
var IdName = "";
var aId = "";
IdName = "APPName";
cellValue = getValue( IdName + index );
for(var i = 0; i < AppNum; i++)
{
if( cellValue == getValue("Line_APPName" + i) )
{
return;
}
}
APP_PARA[AppNum] = cellValue;
newline = getObj("ApplicationList_Table").insertRow(-1);
newline.setAttribute("class", "white");
newline.setAttribute("className", "white");
cellSize = 50;
cellId = "Line_" + IdName + AppNum;
aId    = "Href_" + IdName + AppNum;
newCell = newline.insertCell(-1);
newCell.setAttribute("class", "hreftext");
newCell.setAttribute("className", "hreftext");
newCell.innerHTML = getNameValue(cellId, cellSize, aId, "", AppNum);
setValue(cellId, cellValue);
newCell = newline.insertCell(-1);
newCell.innerHTML = getImagefrmClass("multiImg_modify",
"Modify(" + AppNum + ")",
"modify" + AppNum);
newCell.id = "modify_" + (AppNum).toString();
newCell = newline.insertCell(-1);
newCell.innerHTML = getImagefrmClass("multiImg_delete",
"Delete(" + AppNum + ")",
"delete" + AppNum);
newCell.id = "delete_" + (AppNum).toString();
AppNum++;
}
function showTable()
{
num = getValue("IF_INSTNUM");
if( num > 0)
{
for(var i = 0; i < num; i++)
{
addline(i);
}
}
else
{
var newline = getObj("ApplicationList_Table").insertRow(-1);
newline.setAttribute("align", "center");
newline.setAttribute("class", "white");
newline.setAttribute("className", "white");
var objcell =  newline.insertCell(-1);
objcell.colSpan = 3;
objcell.innerHTML= "&?note_007;";
}
}
function pageGetValue()
{
showTable();
}
function getmsg(id)
{
var str     = new Array();
str[0]   = new Array(101, "&?error_101;");
str[1]   = new Array(108, "&?error_108;");
str[2]   = new Array(118, "&?error_118;");
str[3]   = new Array(119, "&?error_119;");
str[4]   = new Array(122, "&?error_122;");
str[5]   = new Array(144, "&?error_144;");
str[6]   = new Array(155, "&?error_155;");
str[7]   = new Array(156, "&?error_156;");
str[8]   = new Array(127, "&?error_127;");
return getMsgFormArray(str, arguments);
}
function pageSetValue()
{
var num = getValue("IF_INSTNUM");
HiddenParaInit(APPLIST_PARA);
for(var i = 0; i < num; i++)
{
jslSetValue("WANCViewName" + i,     "Frm_WANCViewName");
jslSetValue("InternalHost" + i,     "Frm_InternalHost");
jslSetValue("AppName" + i,          "Line_AppName" + i);
jslViewToPostCheckBox("Enable" + i, "Line_Enable" + i);
}
}
function disableAllButton()
{
var num = AppNum;
for( var btn_i = 0; btn_i < num; btn_i++)
{
jslDisable("delete" + btn_i);
jslDisable("modify" + btn_i);
}
}
function Modify(i)
{
getObj("fSubmit").action = getURL("app_application_conf_t.gch", "vister", "app_application_list_conf_t.gch");
setValue("IF_APPName", APP_PARA[i]);
DisableALL();
getObj("fSubmit").submit();
}
function Delete(i)
{
setValue("IF_APPName", APP_PARA[i]);
setValue("IF_ACTION", "delete");
setValue("IF_INDEX",i);
DisableALL();
getObj("fSubmit").submit();
}
function newApplication()
{
disableAllButton();
window.location.href = getURL("app_application_conf_t.gch", "vister", "app_application_list_conf_t.gch");
}
</script>