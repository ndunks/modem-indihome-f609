<script language="javascript">
var PROUTE_PARA = new Array(
"Interfacename",
"Protocol",
"SrcPrefixIP_SrcPrefixLen",
"DestPrefixIP_DestPrefixLen",
"SrcPort",
"DestPort"
);
var PROUTE_PARA_HIDDEN = new Array(
"SrcInterface",
"DestInterface",
"SrcPrefixIP",
"SrcPrefixLen",
"DestPrefixIP",
"DestPrefixLen",
"SrcMAC",
"Protocol",
"SrcPort",
"DestPort"
);
var index ="";
function getmsg(id)
{
var str      = new Array();
str[0]   = new Array(115, "&?error_115;");
str[1]   = new Array(116, "&?error_116;");
str[2]   = new Array(117, "&?error_117;");
str[3]   = new Array(110, "&?error_110;");
str[4]   = new Array(142, "&?error_142;");
str[5]   = new Array(200, "&?error_200;");
str[6]   = new Array(203, "&?error_203;");
str[7]   = new Array(204, "&?error_204;");
str[8]   = new Array(123, "&?error_123;");
return getMsgFormArray(str, arguments);
}
function pageLoad(url)
{
getObj("fSubmit").action = url;
var msg = "";
var errstr= getValue("IF_ERRORSTR");
var errpara = getValue("IF_ERRORPARAM");
OldProcessRet(errstr, errpara);
moveErrLayer(580,40);
showTable();
}
function getNameValue(id, size, value)
{
return ("<input type=\"text\" class=\"uiNoBorder\" size=\"" + size +"\" value=\""
+ HTMLEnCode(value) + "\"  id=\"" + id + "\"  readonly>");
}
function showTable()
{
var num = getValue("IF_INSTNUM");
if( num > 0)
{
for(var i = 0; i < num; i++)
{
addline(i);
}
}
else
{
var newline = getObj("proute_Table").insertRow(-1);
newline.setAttribute("align", "center");
newline.setAttribute("class", "white");
newline.setAttribute("className", "white");
var objcell =  newline.insertCell(-1);
objcell.colSpan = 5;
objcell.innerHTML= "&?note_007;";
}
}
function addline(index)
{
var newline  = getObj("proute_Table").insertRow(-1);
var newline2 = getObj("proute_Table").insertRow(-1);
var cellId = "";
var cellSize = 10;
var cellValue = "";
newline.setAttribute("class", "white");
newline.setAttribute("className", "white");
for(var i = 0; i < PROUTE_PARA.length ; i+=2)
{
cellId = "Line_" + index + "_" + PROUTE_PARA[i] + "_" + i;
if(PROUTE_PARA[i]=="Interfacename")
{
cellValue = getValue(PROUTE_PARA[i]+index);
}
else if ( PROUTE_PARA[i]=="SrcPrefixIP_SrcPrefixLen" )
{
var SrcPrefixIP = getValue("SrcPrefixIP"+index);
cellValue = SrcPrefixIP;
if ("::" == SrcPrefixIP)
{
cellValue = "";
}
}
else
{
cellValue = getValue(PROUTE_PARA[i]+index);
if(cellValue=="0" && PROUTE_PARA[i]=="SrcPort")
{
cellValue="";
}
}
newline.insertCell(-1).innerHTML = getNameValue(cellId, cellSize, cellValue);
}
var SrcMAC = getValue("SrcMAC"+index);
if( SrcMAC == "00:00:00:00:00:00" )
{
SrcMAC = "";
}
newCell = newline.insertCell(-1);
newCell.innerHTML = getNameValue("", cellSize, SrcMAC);
newCell.id = "SrcMAC_" + (2*index).toString();
newCell = newline.insertCell(-1);
newCell.innerHTML = getImagefrmClass("multiImg_delete", "pageDel("+index+")", "delete" + index);
newCell.id = "delete_" + (2*index).toString();
newline2.setAttribute("class", "white");
newline2.setAttribute("className", "white");
for(var i = 1; i < PROUTE_PARA.length ; i+=2)
{
cellId = "Line_" + index + "_" + PROUTE_PARA[i] + "_" + i;
if ( PROUTE_PARA[i]=="DestPrefixIP_DestPrefixLen" )
{
var DestPrefixIP = getValue("DestPrefixIP"+index);
cellValue = DestPrefixIP;
if ("::" == DestPrefixIP)
{
cellValue = "";
}
}
else
{
cellValue = getValue(PROUTE_PARA[i]+index);
if(cellValue=="0"&&PROUTE_PARA[i]=="DestPort")
{
cellValue = "";
}
}
newline2.insertCell(-1).innerHTML = getNameValue(cellId, cellSize, cellValue);
}
var obj0 = getObj("SrcMAC_" + (2*index).toString());
obj0.rowSpan++;
var obj10 = getObj("delete_" + (2*index).toString());
obj10.rowSpan++;
}
function MacSetValue()
{
var value = getValue("mac1");
value += ":" + getValue("mac2");
value += ":" + getValue("mac3");
value += ":" + getValue("mac4");
value += ":" + getValue("mac5");
value += ":" + getValue("mac6");
if( ":::::" == value)
{
value = "";
}
return value;
}
function pageSetValue()
{
HiddenParaInit(PROUTE_PARA_HIDDEN);
jslSetValue("DestInterface", "Frm_DestInterface");
if(getValue("Frm_SrcPrefixIP")=="")
{
setValue("SrcPrefixIP","NULL");
}
else
{
jslSetValue("SrcPrefixIP", "Frm_SrcPrefixIP");
}
if(getValue("Frm_SrcPrefixLen")!="")
{
jslSetValue("SrcPrefixLen", "Frm_SrcPrefixLen");
}
if(getValue("Frm_DestPrefixIP")=="")
{
setValue("DestPrefixIP","NULL");
}
else
{
jslSetValue("DestPrefixIP", "Frm_DestPrefixIP");
}
if(getValue("Frm_DestPrefixLen")!="")
{
jslSetValue("DestPrefixLen", "Frm_DestPrefixLen");
}
jslSetValue("Protocol", "Frm_Protocol");
if(getValue("Frm_SrcPort")=="")
{
setValue("SrcPort","0");
}
else
{
jslSetValue("SrcPort", "Frm_SrcPort");
}
if(getValue("Frm_DestPort")=="")
{
setValue("DestPort","0");
}
else
{
jslSetValue("DestPort", "Frm_DestPort");
}
var value = MacSetValue();
if(value=="")
{
setValue("SrcMAC", "NULL");
}
else
{
setValue("SrcMAC", value);
}
}
function Check_IntegerRange(value,min,max,Frm,Fnt)
{
var tem = checkIntegerRange(value,min,max);
if(tem==-2)
{
msg = getmsg(115);
ShowErrorForCom(Frm,Fnt,msg);
return false;
}
else if(tem==-3)
{
msg = getmsg(116,min,max);
ShowErrorForCom(Frm,Fnt,msg);
return false;
}
else
{
}
return true;
}
function Check_PrefixValue(FrmPrefix, FntPrefix, FrmPrefixLen, min, max)
{
var msg;
var prefixValue = getValue(FrmPrefix);
var prefixLenValue = getValue(FrmPrefixLen);
if ( "" == prefixValue )
{
return true;
}
if((false == checkIPV6Address(prefixValue)))
{
msg = getmsg(200);
ShowErrorForCom(FrmPrefix, FntPrefix, msg);
return false;
}
if (prefixLenValue!=0 && prefixValue=="::")
{
msg = getmsg(123);
ShowErrorForCom(FrmPrefix, FntPrefix, msg);
return false;
}
return true;
}
function pageCheckValue(insId)
{
var msg  = "";
if(Check_PrefixValue("Frm_SrcPrefixIP", "Fnt_SrcPrefixIP", "Frm_SrcPrefixLen", 0, 128) != true)
{
return false;
}
if(Check_PrefixValue("Frm_DestPrefixIP", "Fnt_DestPrefixIP", "Frm_DestPrefixLen", 0, 128) != true)
{
return false;
}
var protocol = getValue("Frm_Protocol");
var SrcPort = getValue("Frm_SrcPort");
if(Check_IntegerRange(SrcPort,1,65535,"Frm_SrcPort","Fnt_SrcPort")!=true)
{
return false;
}
else if( SrcPort != "" &&  protocol != "TCP" && protocol != "UDP")
{
msg = getmsg(142);
ShowErrorForCom("Frm_SrcPort", null, msg);
return false;
}
else
{
}
var DestPort=getValue("Frm_DestPort");
if(Check_IntegerRange(DestPort,1,65535,"Frm_DestPort","Fnt_DestPort")!=true)
{
return false;
}
else if( DestPort != "" && protocol != "TCP" && protocol != "UDP")
{
msg = getmsg(142);
ShowErrorForCom("Frm_DestPort", null, msg);
return false;
}
else
{
}
var value = MacSetValue();
if(value!="")
{
if(checkMACAddress(value)!=true||value=="00:00:00:00:00:00")
{
msg = getmsg(110);
ShowErrorForCom("mac1","Fnt_SrcMAC",msg);
return false;
}
}
return true;
}
function pageAdd()
{
ReSetValueRmZero("Frm_SrcPort","Frm_DestPort");
if(true == pageCheckValue(-1))
{
DisableALL();
pageSetValue();
setValue("IF_ACTION", "new");
setValue("IF_INDEX", "-1");
getObj("fSubmit").submit();
}
else
{
}
}
function pageDel(i)
{
DisableALL();
setValue("IF_ACTION", "delete");
setValue("IF_INDEX",i);
getObj("fSubmit").submit();
}
</script>