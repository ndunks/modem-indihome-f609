<script language="javascript">
var USB_PARA = new Array(
"DiskName",
"ParStatus",
"FSType",
"StorBlockSize",
"StorFreeSize",
"Path"
);
var TAG_PARA = new Array(
"&?usb11;",
"&?usb07;",
"&?usb05;",
"&?usb15;",
"&?usb16;",
"&?usb06;"
);
var index  = "";
function getmsg(id)
{
var str  = new Array();
str[0]   = new Array(118, "&?error_118;");
str[1]   = new Array(119, "&?error_119;");
str[2]   = new Array(122, "&?error_122;");
str[3]   = new Array(196, "&?error_196;");
return getMsgFormArray(str, arguments);
}
function pageLoad(url)
{
getObj("fSubmit").action = url;
var errstr= getValue("IF_ERRORSTR");
var errpara = getValue("IF_ERRORPARAM");
if(errstr != "SUCC" && errpara != "SUCC")
{
ProcessRet(errstr, errpara);
}
else if(errstr != "SUCC" && errpara == "SUCC")
{
msg = getmsg(196);
ShowErrorForCom(null, null, msg);
}
showTable();
pageGetValue();
}

function getInput(id,len)
{
return ("<input  type=\"text\"  size=\""+len+"\" id=\""+id+"\" readonly>");
}
function insertBtn(tag,func)
{
return ("<input name=\"button\" type=\"button\" class=\"button3\" onclick=\""+func+"\" value=\""+HTMLEnCode(tag)+"\" />");
}

function showTable()
{
var flag;
var bflag;
var num = getValue("IF_INSTNUM");
if(num == 0 || num == "0")
{
var apaceTr = getObj("USB_Table").insertRow(-1);
apaceTr.setAttribute("align", "center");
var spaceline = apaceTr.insertCell(-1);
var objcelltmp = apaceTr.insertCell(-1);
objcelltmp.parentNode.removeChild(objcelltmp);
spaceline.colSpan = 2;
spaceline.innerHTML =  "&?usb09;";
}
for(var i = 0; i < num ; i++)
{
flag   = 1;
for(var j = 0; j < USB_PARA.length ; j++)
{
if(i > 0 && j == 0)
{
var h=i-1;
if(getValue("DevNum" + i) == getValue("DevNum" +h))
{
flag = 0;
}
}
if(flag == 1 || USB_PARA[j]  != "DiskName")
{
var tr = getObj("USB_Table").insertRow(-1);
var tagTd = tr.insertCell(-1);
tagTd.setAttribute("class", "td1");
tagTd.setAttribute("className", "td1");
tagTd.innerHTML = TAG_PARA[j];
var valueTd = tr.insertCell(-1);
valueTd.setAttribute("class", "td2");
valueTd.setAttribute("className", "td2");
valueTd.innerHTML = getInput("Frm_"+USB_PARA[j] + i,32);
}
}
bflag = 1;
if(i < num - 1)
{
var g = i +1;
if(getValue("DevNum" + i) == getValue("DevNum" + g))
{
bflag = 0;
}
}
if(bflag == 1)
{
var apaceTr0 = getObj("USB_Table").insertRow(-1);
var spaceline0 = apaceTr0.insertCell(-1);
spaceline0.innerHTML =  "&nbsp;";
var apaceTr1 = getObj("USB_Table").insertRow(-1);
var spaceline1 = apaceTr1.insertCell(-1);
spaceline1.innerHTML =  "&nbsp;";
}
}
}
function pageGetValue()
{
var num = getValue("IF_INSTNUM");
for(var i = 0; i < num; i++)
{
for(var j = 0; j < USB_PARA.length ; j++)
{
if(i > 0 && j == 0)
{
var h= i-1;
if(getValue("DevNum"+i) != getValue("DevNum"+h))
{
if( 3 == j )
{
setValue("Frm_"+USB_PARA[j]+i,getValue(USB_PARA[j]+i) + " KB");
}
else if( 4 == j )
{
var freesize = getValue(USB_PARA[j] + i);
var totalsize = getValue(USB_PARA[j-1] + i);
var usedpercent = ( ( totalsize - freesize ) / totalsize) * 100;
usedpercent = Math.round(usedpercent);
setValue("Frm_"+USB_PARA[j]+i, getValue(USB_PARA[j]+i) + " KB  \( " + usedpercent + "% used \)");
}
else
{
setValue("Frm_"+USB_PARA[j]+i,getValue(USB_PARA[j]+i));
}
}
}
else
{
if( 3 == j )
{
setValue("Frm_"+USB_PARA[j]+i,getValue(USB_PARA[j]+i) + " KB");
}
else if( 4 == j )
{
var freesize = getValue(USB_PARA[j] + i);
var totalsize = getValue(USB_PARA[j-1] + i);
var usedpercent = ( ( totalsize - freesize ) / totalsize) * 100;
usedpercent = Math.round(usedpercent);
setValue("Frm_"+USB_PARA[j]+i, getValue(USB_PARA[j]+i) + " KB  \( " + usedpercent + "% used \)");
}
else
{
setValue("Frm_"+USB_PARA[j]+i,getValue(USB_PARA[j]+i));
}
}
}
}
}
function pageSetValue(index)
{
HiddenParaInit(USB_PARA);
}
function pageCheckValue()
{
return true;
}
function Remove(index)
{
if(pageCheckValue() == true)
{
pageSetValue(index);
setValue("IF_ACTION", "apply");
setValue("IF_INDEX",index);
DisableALL();
getObj("fSubmit").submit();
}
else
{
}
}
function pageReFresh()
{
DisableALL();
getObj("fSubmit").submit();
}
</script>