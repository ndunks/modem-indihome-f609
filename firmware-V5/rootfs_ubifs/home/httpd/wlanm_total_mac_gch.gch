<%
IMPORT FILE "common_gch.gch";
IMPORT FILE "wlan_mac_filter_gch.gch";
IMPORT FILE "wlan_config_gch.gch";
IMPORT FILE "wlan_driver_gch.gch";
var FP_VIEWID, FP_CONFIGTAG, FP_WLANMAC_TAG;
var FP_OBJNAME = "OBJ_ACLCFG_ID";
var FP_ACTION   = request("IF_ACTION");
var FP_INDEX    = getInstIndex("new");
create_form_start("fSubmit", "");
createHigherHidden(FP_INDEX);
FP_VIEWID = request("IF_VIEWID");
FP_CONFIGTAG = "Y";
FP_WLANMAC_TAG = "Y";
var WLAN_OBJNAME = "OBJ_WLANCONFIG_ID";
var WLAN_INSTNUM;
if(getenv("CurrentVersionInfo") == 23)
{
WLAN_INSTNUM = query_list(WLAN_OBJNAME, "IGD");
}
else
{
WLAN_INSTNUM = query_list(WLAN_OBJNAME, getenv("g_wlanSettingID"));
}
var WLAN_IDENTITY = "";
create_hidden_sep("WLAN_INSTNUM", WLAN_INSTNUM);
if (FP_VIEWID IS NULL)
{
FP_VIEWID = query_identity(0);
}
var flag = 0;
for (var i=0; i<WLAN_INSTNUM; i++)
{
WLAN_IDENTITY = query_identity(i);
create_hidden_sep("WLAN_SSID"+i, WLAN_IDENTITY);
if (FP_VIEWID == WLAN_IDENTITY)
{
flag = 1;
}
}
if (flag == 0)
{
FP_CONFIGTAG = "N";
FP_WLANMAC_TAG = "N";
FP_VIEWID = query_identity(0);
}
create_hidden_sep("IF_VIEWID", FP_VIEWID);

var FP_ERRORSTR = "SUCC";
FP_ERRORSTR = wlan_mac(FP_ACTION, FP_WLANMAC_TAG, FP_INDEX , FP_ERRORSTR);

if ("new" == FP_ACTION || "delete" == FP_ACTION)
{
FP_ACTION = "";
}
FP_ERRORSTR = config_func(FP_ACTION, FP_CONFIGTAG, FP_VIEWID, FP_ERRORSTR);
FP_ERRORSTR = driver_func(FP_VIEWID, FP_ERRORSTR);
set_hidden("IF_INSTNUM", getInstNum(FP_OBJNAME));

create_form_end();
%>
