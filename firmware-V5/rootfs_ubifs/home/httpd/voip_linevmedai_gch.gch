<%
IMPORT FILE "common_gch.gch";
var ALL_INSTNUM, LINE_IDENTITY, LINE_INSTNUM, FP_INSTNUM, FP_IDENTITY, FP_HANDLE;
var PARA[9] =
{
"MediaVEnable",
"MediaVType",
"MediaVCodec",
"MediaVPV",
"MediaVPT",
"MediaVCR",
"MediaVPri",
"MediaSSuprs",
"MediaRSSuprs"
};
var VPCODEC_OBJNAME = "OBJ_VOIPVPCODEC_ID";
var FP_PARANUM = 9;
var LINE_OBJNAME = "OBJ_VOIPVPLINE_ID";
var FP_OBJNAME = "OBJ_VOIPLINEVMEDAI_ID";
var FP_ERRORSTR = "SUCC";
var FP_MULTIDISPLAY = 1;
var FP_ACTION = request("IF_ACTION");
var FP_IDENTITY1 = "";
create_form_start("fSubmit", "");
createBasicHidden();

if (FP_ACTION == "apply")
{
ALL_INSTNUM = 0;
LINE_INSTNUM = query_list(LINE_OBJNAME, "IGD");
for (var i=0; i<LINE_INSTNUM; i++)
{
query_list(LINE_OBJNAME, "IGD");
LINE_IDENTITY = query_identity(i);
FP_INSTNUM = query_list(FP_OBJNAME, LINE_IDENTITY);
for (var j=0; j<FP_INSTNUM; j++)
{
FP_IDENTITY = query_identity(j);
FP_HANDLE = create_paralist();
for(var k=0; k< FP_PARANUM; k++)
{
set_multiinst_para(FP_HANDLE, PARA[k], ALL_INSTNUM);
}
FP_IDENTITY = set_inst(FP_HANDLE, FP_OBJNAME, FP_IDENTITY);
ALL_INSTNUM = ALL_INSTNUM + 1;
}
}
query_list(VPCODEC_OBJNAME, "IGD");
var VPCODEC_IDENTITY1 = query_identity(0);
var FP_HANDLE1 = create_paralist();
setpara(FP_HANDLE1,"NegoLocPri");
FP_IDENTITY1 = set_inst(FP_HANDLE1, VPCODEC_OBJNAME, VPCODEC_IDENTITY1);
}
var FP_HANDLE2 = create_paralist();
query_list(VPCODEC_OBJNAME, "IGD");
var VPCODEC_IDENTITY = query_identity(0);
get_inst(FP_HANDLE2, VPCODEC_OBJNAME, VPCODEC_IDENTITY);
create_hidden_sep("NegoLocPri",get_para(FP_HANDLE2,"NegoLocPri"));
destroy_paralist(FP_HANDLE2);
if (FP_MULTIDISPLAY == 1)
{
ALL_INSTNUM = 0;
LINE_INSTNUM = query_list(LINE_OBJNAME, "IGD");
for (var i=0; i<LINE_INSTNUM; i++)
{
LINE_INSTNUM = query_list(LINE_OBJNAME, "IGD");
LINE_IDENTITY = query_identity(i);
FP_INSTNUM = query_list(FP_OBJNAME, LINE_IDENTITY);
for(var j=0; j<FP_INSTNUM; j++)
{
FP_HANDLE = create_paralist();
FP_IDENTITY = query_identity(j);
get_inst(FP_HANDLE, FP_OBJNAME, FP_IDENTITY);
create_hidden_multiinstpara(FP_HANDLE, PARA, ALL_INSTNUM, FP_PARANUM);
destroy_paralist(FP_HANDLE);
ALL_INSTNUM = ALL_INSTNUM + 1;
}
create_hidden_sep("IF_INSTNUM"+i, FP_INSTNUM);
}
}
FP_ERRORSTR = getDisplayInstError(FP_ERRORSTR);
create_hidden_sep("LINE_INSTNUM", LINE_INSTNUM);
create_hidden_sep("ALL_INSTNUM",  ALL_INSTNUM);
create_form_end();
%>
