<script language="javascript">
function getmsg(id)
{
var str     = new Array();
str[0]   = new Array(116, "&?error_116;");
str[1]   = new Array(117, "&?error_117;");
str[2]   = new Array(175, "&?error_175;");
str[3]   = new Array(115, "&?error_115;");
str[4]   = new Array(101, "&?error_101;");
return getMsgFormArray(str, arguments);
}
function pageLoad(url)
{
getObj("fSubmit").action = url;
var errstr= getValue("IF_ERRORSTR");
var errpara = getValue("IF_ERRORPARAM");
ProcessRet(errstr, errpara);
pageGetValue();
}
function jslDoShowComboBox1(viewid,postid)
{
var i;
var selector = getObj(viewid);
var value = getObj(postid).value;
if(selector==null) return;
for(i=0; i < selector.length; i++)
{
if(selector.options[i].value == value)
{
selector.selectedIndex = i;
return;
}
}
}
function pageGetValue()
{
jslDoShowComboBox1("Frm_Interface", "Interface");
jslDoShowComboBox1("Frm_Protocol", "Protocol");
jslSetValue("Frm_Hops", "MaxHopCount");
jslSetValue("Frm_IdleTime", "Timeout");
if (getValue("IF_MAXTIME") > 0
&& getValue("Flag") == "1"
&& getValue("IF_ERRORSTR") == "SUCC" )
{
jslEnDisplay("Tbl_traceRoute_tip");
jslDisable("Btn_Submit");
jslEnable("Btn_Cancel");
setValue("IF_MAXTIME", getValue("IF_MAXTIME")-1 );
setTimeout("refreshPage()", 3000);
}
else
{
jslDisable("Btn_Cancel");
jslEnable("Btn_Submit");
if (getValue("IF_MAXTIME") == "0")
{
jslEnDisplay("Tbl_traceRoute_tip");
setHTML("Td_traceRoute_tip", "&?TraceRoute001;");
}
setValue("IF_MAXTIME", "500");
}
}
function pageCheckValue()
{
var msg  = "";
var domain=getValue("Frm_Host");
if( checkIpAddress(domain)!=true
<%
if ( 0 != getenv("DevIPv6Effect") )
{
%>
&& checkIPV6Address(domain)!=true
<%
}
%>
&& checkHostName(domain)!=true )
{
msg = getmsg(175);
ShowErrorForCom("Frm_Host","Fnt_Host",msg);
return false;
}
var maxHops = getValue("Frm_Hops");
if (maxHops != "")
{
var mm = checkIntegerRange(maxHops, 1, 64);
if(-2 == mm)
{
msg = getmsg(115);
ShowErrorForCom("Frm_Hops","Fnt_Hops",msg);
return false;
}
else if(-3 == mm)
{
msg = getmsg(116,1,64);
ShowErrorForCom("Frm_Hops","Fnt_Hops",msg);
return false;
}
}
var timeOut = getValue("Frm_IdleTime");
var mm = checkIntegerRange(timeOut, 2000, 10000);
if(-1 == mm)
{
msg = getmsg(101);
ShowErrorForCom("Frm_IdleTime","Fnt_IdleTime",msg);
return false;
}
else if(-2 == mm)
{
msg = getmsg(115);
ShowErrorForCom("Frm_IdleTime","Fnt_IdleTime",msg);
return false;
}
else if(-3 == mm)
{
msg = getmsg(116,2000,10000);
ShowErrorForCom("Frm_IdleTime","Fnt_IdleTime",msg);
return false;
}
return true;
}
function pageSetValue()
{
jslSetValue("Host", "Frm_Host");
jslSetValue("Interface", "Frm_Interface");
jslSetValue("Protocol", "Frm_Protocol");
if (getValue("Frm_Hops") != "")
{
jslSetValue("MaxHopCount", "Frm_Hops");
}
else
{
setValue("MaxHopCount", "0");
}
if (getValue("Frm_IdleTime") != "")
{
jslSetValue("Timeout", "Frm_IdleTime");
}
else
{
setValue("Timeout", "0");
}
}
function pageSubmit()
{
ReSetValueRmZero("Frm_IdleTime","Frm_Hops");
ReSetIpRmZero("Frm_Host");
if(pageCheckValue()==true)
{
pageSetValue();
ReSetValueRmZero("MaxHopCount");
ReSetValueRmZero("Timeout");
setValue("IF_ACTION","start");
setValue("Control","0");
DisableALL();
getObj("fSubmit").submit();
}
}
function pageCancel()
{
DisableALL();
setValue("Control", "1");
setValue("IF_ACTION","stop");
getObj("fSubmit").submit();
}
function refreshPage()
{
DisableALL();
jslEnable("Btn_Cancel");
getObj("fSubmit").submit();
}
</script>