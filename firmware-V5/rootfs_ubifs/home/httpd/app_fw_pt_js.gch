<script language="javascript">
var FW_PARA = new Array(
"Name",
"Enable",
"Timeout",
"TriggleProtocol",
"IncomeProtocol",
"TriggleIpAddress",
"TriggleDestPort",
"IncomeMinPort",
"IncomeMaxPort"
);
var FWPT_PARA = new Array(
"ViewName"
);
function getmsg(id)
{
var str      = new Array();
str[0]   = new Array(122, "&?error_122;");
str[1]   = new Array(118, "&?error_118;");
str[2]   = new Array(119, "&?error_119;");
str[3]   = new Array(108, "&?error_108;");
str[4]   = new Array(101, "&?error_101;");
str[5]   = new Array(102, "&?error_102;");
str[6]   = new Array(103, "&?error_103;");
str[7]   = new Array(114, "&?error_114;");
str[8]   = new Array(115, "&?error_115;");
str[9]   = new Array(116, "&?error_116;");
str[10]  = new Array(117, "&?error_117;");
str[11]  = new Array(535, "&?error_535;");
str[12]  = new Array(534, "&?error_534;");
str[13]  = new Array(537, "&?error_537;");
str[14]  = new Array(538, "&?error_538;");
str[15]  = new Array(539, "&?error_539;");
str[16]  = new Array(541, "&?error_541;");
return getMsgFormArray(str, arguments);
}
function pageLoad(url)
{
getObj("fSubmit").action = url;
var errstr= getValue("IF_ERRORSTR");
var errpara = getValue("IF_ERRORPARAM");
if("not cfg" == errstr)
{
var msg = getmsg(539) + getmsg(537);
ShowErrorForCom(null, null, msg);
}
else if("cfg" == errstr)
{
var msg = getmsg(539) + getmsg(541) + getmsg(538);
ShowNoteForCom(null, null, msg);
}
else
{
OldProcessRet(errstr, errpara);
}
moveErrLayer(595,93);
showTable();
setValue("Frm_Timeout","1200");
}
function getNameValue(id, size, value)
{
return ("<input type=\"text\" class=\"uiNoBorder\" size=\"" + size +"\" value=\""
+ HTMLEnCode(value) + "\"  id=\"" + id + "\"  readonly>");
}
function addline(index)
{
var newline  = getObj("fwpt_Table").insertRow(-1);
var newline2 = getObj("fwpt_Table").insertRow(-1);
var cellId = "";
var cellSize = 10;
var cellValue = "";
newline.setAttribute("class", "white");
newline.setAttribute("className", "white");
var newCell = newline.insertCell(-1);
cellId = "Line_" + index + "_" + FW_PARA[0] + "_" + 0;
newCell.innerHTML = getNameValue(cellId, 4, "");
cellValue = getValue(FW_PARA[0]+index);
setValue(cellId,cellValue);
newCell.id = "Name_" + (2*index).toString();
for(var i = 1; i < FW_PARA.length ; i+=2)
{
cellId = "Line_" + index + "_" + FW_PARA[i] + "_" + i;
if(5 == i)
{
if(getValue(FW_PARA[i]+index) == "0.0.0.0")
{
cellValue = "";
}
else
{
cellValue = getValue(FW_PARA[i]+index);
}
}
else if( 3 == i )
{
cellValue=getSelectListValue(getObj("Frm_"+FW_PARA[i]), getValue(FW_PARA[i]+index));
}
else
{
cellValue = getValue(FW_PARA[i]+index);
}
if(1 == i)
{
newline.insertCell(-1).innerHTML = showIsEnableImage(cellValue, cellId);
}
else
{
newline.insertCell(-1).innerHTML = getNameValue(cellId, cellSize, "");
setValue(cellId, cellValue);
}
}
newCell = newline.insertCell(-1);
newCell.innerHTML = getImagefrmClass("multiImg_modify", "Modify("+index+")", "modify" + index);
newCell.id = "modify_" + (2*index).toString();
newCell = newline.insertCell(-1);
newCell.innerHTML = getImagefrmClass("multiImg_delete", "pageDel("+index+")", "delete" + index);
newCell.id = "delete_" + (2*index).toString();
newline2.setAttribute("class", "white");
newline2.setAttribute("className", "white");
newCell = newline2.insertCell(-1);
newCell.id = "Name_" + (2*index+1).toString();
for(var i = 2; i < FW_PARA.length ; i+=2)
{
cellId = "Line_" + index + "_" + FW_PARA[i] + "_" + i;
if(4 == i)
{
cellValue=getSelectListValue(getObj("Frm_"+FW_PARA[i]), getValue(FW_PARA[i]+index));
}
else
{
cellValue = getValue(FW_PARA[i]+index);
}
newline2.insertCell(-1).innerHTML = getNameValue(cellId, cellSize, "" );
setValue(cellId, cellValue);
}
newCell = newline2.insertCell(-1);
newCell.id = "modify_" + (2*index+1).toString();
newCell = newline2.insertCell(-1);
newCell.id = "delete_" + (2*index+1).toString();
var obj0 = document.getElementById("Name_" + (2*index).toString());
var obj1 = document.getElementById("Name_" + (2*index+1).toString());
obj0.rowSpan++;
obj1.parentNode.removeChild(obj1);
var obj0 = document.getElementById("modify_" + (2*index).toString());
var obj1 = document.getElementById("modify_" + (2*index+1).toString());
obj0.rowSpan++;
obj1.parentNode.removeChild(obj1);
var obj0 = document.getElementById("delete_" + (2*index).toString());
var obj1 = document.getElementById("delete_" + (2*index+1).toString());
obj0.rowSpan++;
obj1.parentNode.removeChild(obj1);
}
function getSelectListValue(obj, optionValue)
{
for (var i = 0 ;i < obj.length ;i++ )
{
if(obj.options[i].value == optionValue)
{
return obj.options[i].text;
}
}
return "";
}
function showTable()
{
var num = getValue("IF_INSTNUM");
if( num > 0)
{
for(var i = 0; i < num; i++)
{
addline(i);
}
}
else
{
var newline = getObj("fwpt_Table").insertRow(-1);
newline.setAttribute("align", "center");
newline.setAttribute("class", "white");
newline.setAttribute("className", "white");
var objcell =  newline.insertCell(-1);
objcell.colSpan = 7;
objcell.innerHTML= "&?note_007;";
}
}
function Modify(i)
{
jslDiDisplay("Btn_Add");
jslEnDisplay("Btn_Edit");
document.getElementById("back").style.display="";
modifyGetValue(i);
index = i;
}
function modifyGetValue(i)
{
jslPostToViewCheckBox("Frm_Enable", "Enable"+i);
jslSetValue("Frm_Name", "Name"+i);
if(getValue("TriggleIpAddress"+i) == "0.0.0.0")
{
setValue("Frm_TriggleIpAddress", "");
}
else
{
jslSetValue("Frm_TriggleIpAddress", "TriggleIpAddress"+i);
}
jslSetValue("Frm_TriggleProtocol", "TriggleProtocol"+i);
jslSetValue("Frm_TriggleDestPort", "TriggleDestPort"+i);
jslSetValue("Frm_IncomeProtocol", "IncomeProtocol"+i);
jslSetValue("Frm_IncomeMinPort", "IncomeMinPort"+i);
jslSetValue("Frm_IncomeMaxPort", "IncomeMaxPort"+i);
jslSetValue("Frm_Timeout", "Timeout"+i);
}
function Check_IntegerRange(value,min,max,Frm,Fnt)
{
var tem = checkIntegerRange(value,min,max);
if(tem==-1)
{
msg = getmsg(101);
ShowErrorForCom(Frm,Fnt,msg);
return false;
}
else if(tem==-2)
{
msg = getmsg(115);
ShowErrorForCom(Frm,Fnt,msg);
return false;
}
else if(tem==-3)
{
msg = getmsg(116,min,max);
ShowErrorForCom(Frm,Fnt,msg);
return false;
}
return true;
}
function pageCheckValue(insId)
{
var msg;
var name = getValue("Frm_Name");
if(false == checkAPPNameForASC(name))
{
msg = getmsg(114);
ShowErrorForCom("Frm_Name", "Fnt_Name", msg);
return false;
}
else if(checkStrLengthRange(name, 1, 32) == "-1")
{
msg = getmsg(101);
ShowErrorForCom("Frm_Name", "Fnt_Name", msg);
return false;
}
else if(checkStrLengthRange(name, 1, 32) == "-3")
{
msg = getmsg(102, 1, 32);
ShowErrorForCom("Frm_Name", "Fnt_Name", msg);
return false;
}
var TriggleIpAddress = getValue("Frm_TriggleIpAddress");
if(TriggleIpAddress != "")
{
if(TriggleIpAddress == "0.0.0.0")
{
msg = getmsg(108);
ShowErrorForCom("Frm_TriggleIpAddress", "Fnt_TriggleIpAddress", msg);
return false;
}
else if(checkIpAddress(TriggleIpAddress,"")!=true)
{
msg =  getmsg(108);
ShowErrorForCom("Frm_TriggleIpAddress", "Fnt_TriggleIpAddress", msg);
return false;
}
}
var TriggleDestPort = getValue("Frm_TriggleDestPort");
if(Check_IntegerRange(TriggleDestPort,1,65535,"Frm_TriggleDestPort","Fnt_TriggleDestPort")!=true)
{
return false;
}
var IncomeMinPort = getValue("Frm_IncomeMinPort");
if(Check_IntegerRange(IncomeMinPort,1,65535,"Frm_IncomeMinPort","Fnt_IncomeMinPort")!=true)
{
return false;
}
var IncomeMaxPort = getValue("Frm_IncomeMaxPort");
if(Check_IntegerRange(IncomeMaxPort,1,65535,"Frm_IncomeMaxPort","Fnt_IncomeMaxPort")!=true)
{
return false;
}
if(IncomeMinPort - IncomeMaxPort > 0)
{
msg =  getmsg(535);
ShowErrorForCom("","",msg);
return false;
}
if(1 > IncomeMaxPort-IncomeMinPort||IncomeMaxPort-IncomeMinPort > 9)
{
msg =  getmsg(534);
ShowErrorForCom("","",msg);
return false;
}
var  Timeout = getValue("Frm_Timeout");
if(Check_IntegerRange(Timeout,60,1800,"Frm_Timeout","Fnt_Timeout")!=true)
{
return false;
}
return true;
}
function checkAPPNameForASC(value)
{
var length = value.length;
for(var j = 0 ;j < length; j++)
{
var xx = value.charCodeAt(j);
if (xx >= 32 && xx <= 126 )
{
}
else
{
return false;
}
}
return true;
}
function pageSetValue()
{
HiddenParaInit(FW_PARA);
HiddenParaInit(FWPT_PARA);
jslViewToPostCheckBox("Enable", "Frm_Enable");
jslSetValue("Name", "Frm_Name");
if(getValue("Frm_TriggleIpAddress") == "")
{
setValue("TriggleIpAddress","0.0.0.0");
}
else
{
jslSetValue("TriggleIpAddress", "Frm_TriggleIpAddress");
}
jslSetValue("TriggleProtocol", "Frm_TriggleProtocol");
jslSetValue("TriggleDestPort", "Frm_TriggleDestPort");
jslSetValue("IncomeProtocol", "Frm_IncomeProtocol");
jslSetValue("IncomeMinPort", "Frm_IncomeMinPort");
jslSetValue("IncomeMaxPort", "Frm_IncomeMaxPort");
jslSetValue("Timeout", "Frm_Timeout");
}
function disableAllButton()
{
jslDisable("Btn_Add","Btn_Edit", "back");
var num = getValue("IF_INSTNUM");
for( var btn_i = 0; btn_i < num; btn_i++)
{
jslDisable("delete" + btn_i);
jslDisable("modify" + btn_i);
}
}
function pageAdd()
{
jslEnDisplay("Btn_Add");
jslDiDisplay("Btn_Edit");
ReSetIpRmZero("Frm_TriggleIpAddress");
ReSetValueRmZero("Frm_TriggleDestPort","Frm_IncomeMinPort",
"Frm_IncomeMaxPort","Frm_Timeout");
if(true == pageCheckValue(-1))
{
disableAllButton();
pageSetValue();
setValue("IF_ACTION", "new");
setValue("IF_INDEX", "-1");
DisableALL();
getObj("fSubmit").submit();
}
else
{
}
}
function pageEdit()
{
ReSetIpRmZero("Frm_TriggleIpAddress");
ReSetValueRmZero("Frm_TriggleDestPort","Frm_IncomeMinPort",
"Frm_IncomeMaxPort","Frm_Timeout");
if(true == pageCheckValue(index))
{
disableAllButton();
pageSetValue();
setValue("IF_ACTION", "apply");
setValue("IF_INDEX", index);
DisableALL();
getObj("fSubmit").submit();
}
else
{
}
}
function pageDel(i)
{
setValue("IF_ACTION", "delete");
setValue("IF_INDEX",i);
DisableALL();
getObj("fSubmit").submit();
}
function back4add()
{
var number = getValue("IF_INSTNUM");
DisableALL();
getObj("fSubmit").submit();
}
</script>