<script language="javascript">
function getmsg(id)
{
var str  = new Array();
str[0]   = new Array(165, "&?error_165;");
str[1]   = new Array(110, "&?msg_110;");
str[2]   = new Array(112, "&?msg_112;");
str[3]   = new Array(116, "&?msg_116;");
str[4]   = new Array(117, "&?msg_117;");
return getMsgFormArray(str, arguments);
}
function msgCallback()
{
setValue("IF_UPLOADING", "1");
jslDisable("download", "upload");
getObj("fUpload").action = "getpage.gch?pid=100&&"+getValue("UPLOAD_SESSION_TOKEN")+"&nextpage=<%=encodeJS(request("nextpage"));%>";
getObj("FileUploading").style.display = "";
document.fUpload.submit();
}
function myUploadFile()
{
if (getValue("DefCfgUpload") != "")
{
checkSessionToken(checkPassUploadFile);
}
else
{
getObj("FileUploading").style.display = "none";
moveErrLayer(580,145);
msg = getmsg(165);
ShowErrorForCom(null, null, msg);
}
}
function checkPassUploadFile()
{
var msg = getmsg(112);
var att = getmsg(110);
var msgcon = getmsg(116);
var msgcan = getmsg(117);
var msgJSONData = {
title:att,
content:msg,
confirmLabel:msgcon,
cancelLabel:msgcan,
confirmCallback:'msgCallback()',
cancelDisplay:'yes',
focusButtun:'Cancel'
};
msgbox(msgJSONData);
}
function myDownloadFile()
{
checkSessionToken(checkPassDownloadFile);
}
function checkPassDownloadFile()
{
document.fDownload.submit();
}
function pageLoad(url)
{
}
function checkSessionToken(successCall)
{
var ajaxObj = new AJAXObj();
ajaxObj.addPostItem("UPLOAD_ENV", getValue("UPLOAD_SESSION_TOKEN"));
ajaxObj.post("checkSessionToken.gch", checkSessionTokenCallBack);
function checkSessionTokenCallBack()
{
if ( ajaxObj.getReadyState() == xmlHTTPStatus['Loaded']
&& 200 == ajaxObj.getStatus() )
{
var resultText = ajaxObj.getResponseText();
if( -1 != resultText.indexOf("SUCC"))
{
successCall();
}
else
{
moveErrLayer(580,145);
ShowErrorForCom(null, null, "&?csp_token_expired;");
}
}
}
}
</script>