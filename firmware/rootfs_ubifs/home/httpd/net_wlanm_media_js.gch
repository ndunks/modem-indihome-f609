<script language="javascript">
var MEDIA_PARA = new Array(
"AIFSN",
"ECWMin",
"ECWMax",
"TXOP",
"Type",
"Qlength",
"SRL",
"LRL"
);
function getmsg(id)
{
var str  = new Array();
str[0]   = new Array(101, "&?error_101;");
str[1]   = new Array(102, "&?error_102;");
str[2]   = new Array(103, "&?error_103;");
str[3]   = new Array(113, "&?error_113;");
str[4]   = new Array(118, "&?error_118;");
str[5]   = new Array(119, "&?error_119;");
str[6]   = new Array(122, "&?error_122;");
str[7]   = new Array(115, "&?error_115;");
str[8]   = new Array(116, "&?error_116;");
str[9]   = new Array(117, ".");
str[10]   = new Array(191, "&?error_191;");
return getMsgFormArray(str, arguments);
}
function Wireless_switch()
{
if(getValue("RealRF") == "1")
{
if ( "0" == getValue("CardIsIn") )
{
setHTML("tipLi", "&?cwt024;");
jslEnDisplay("t_warn");
}
jslEnable("Frm_MEDIAIndex","Frm_AIFSN","Frm_ECWMin","Frm_ECWMax","Frm_TXOP","Frm_Qlength","Frm_SRL","Frm_LRL","Btn_Submit","Btn_Cancel");
}
else
{
setHTML("tipLi", "&?wlan079;");
jslEnDisplay("t_warn");
jslDisable("Frm_MEDIAIndex","Frm_AIFSN","Frm_ECWMin","Frm_ECWMax","Frm_TXOP","Frm_Qlength","Frm_SRL","Frm_LRL","Btn_Submit","Btn_Cancel");
}
}
function pageCheckValue()
{
var msg;
var value = checkIntegerRange(getValue("Frm_AIFSN"),2,15);
if(value == -1)
{
msg = getmsg(101);
ShowErrorForCom("Frm_AIFSN","Fnt_AIFSN",msg);
return false;
}
else if(value == -2)
{
msg = getmsg(115);
ShowErrorForCom("Frm_AIFSN","Fnt_AIFSN",msg);
return false;
}
else if(value == -3)
{
msg = getmsg(116,2,15);
ShowErrorForCom("Frm_AIFSN","Fnt_AIFSN",msg);
return false;
}
var value1 = checkIntegerRange(getValue("Frm_ECWMin"),0,15);
if(value1 == -1)
{
msg = getmsg(101);
ShowErrorForCom("Frm_ECWMin","Fnt_ECWMin",msg);
return false;
}
else if(value1 == -2)
{
msg = getmsg(115);
ShowErrorForCom("Frm_ECWMin","Fnt_ECWMin",msg);
return false;
}
else if(value1 == -3)
{
msg = getmsg(116,0,15);
ShowErrorForCom("Frm_ECWMin","Fnt_ECWMin",msg);
return false;
}
var value2 = checkIntegerRange(getValue("Frm_ECWMax"),0,15);
if(value2 == -1)
{
msg = getmsg(101);
ShowErrorForCom("Frm_ECWMax","Fnt_ECWMax",msg);
return false;
}
else if(value2 == -2)
{
msg = getmsg(115);
ShowErrorForCom("Frm_ECWMax","Fnt_ECWMax",msg);
return false;
}
else if(value2 == -3)
{
msg = getmsg(116,0,15);
ShowErrorForCom("Frm_ECWMax","Fnt_ECWMax",msg);
return false;
}
var MaxValue = getValue("Frm_ECWMax");
var MinValue = getValue("Frm_ECWMin");
var min = getObj("Fnt_ECWMin").innerHTML;
if(parseInt(MaxValue) < parseInt(MinValue) || parseInt(MaxValue) == parseInt(MinValue))
{
msg = getmsg(191);
msg = msg + min +"&?wmedia009;";
ShowErrorForCom("Frm_ECWMax","Fnt_ECWMax",msg);
return false;
}
var value3 = checkIntegerRange(getValue("Frm_TXOP"),0,255);
if(value3 == -1)
{
msg = getmsg(101);
ShowErrorForCom("Frm_TXOP","Fnt_TXOP",msg);
return false;
}
else if(value3 == -2)
{
msg = getmsg(115);
ShowErrorForCom("Frm_TXOP","Fnt_TXOP",msg);
return false;
}
else if(value3 == -3)
{
msg = getmsg(116,0,255);
ShowErrorForCom("Frm_TXOP","Fnt_TXOP",msg);
return false;
}
var value4 = checkIntegerRange(getValue("Frm_Qlength"),0,1000);
if(value4 == -1)
{
msg = getmsg(101);
ShowErrorForCom("Frm_Qlength","Fnt_Qlength",msg);
return false;
}
else if(value4 == -2)
{
msg = getmsg(115);
ShowErrorForCom("Frm_Qlength","Fnt_Qlength",msg);
return false;
}
else if(value4 == -3)
{
msg = getmsg(116,0,1000);
ShowErrorForCom("Frm_Qlength","Fnt_Qlength",msg);
return false;
}
var value5 = checkIntegerRange(getValue("Frm_SRL"),0,255);
if(value5 == -1)
{
msg = getmsg(101);
ShowErrorForCom("Frm_SRL","Fnt_SRL",msg);
return false;
}
else if(value5 == -2)
{
msg = getmsg(115);
ShowErrorForCom("Frm_SRL","Fnt_SRL",msg);
return false;
}
else if(value5 == -3)
{
msg = getmsg(116,0,255);
ShowErrorForCom("Frm_SRL","Fnt_SRL",msg);
return false;
}
var value6 = checkIntegerRange(getValue("Frm_LRL"),0,255);
if(value6 == -1)
{
msg = getmsg(101);
ShowErrorForCom("Frm_LRL","Fnt_LRL",msg);
return false;
}
else if(value6 == -2)
{
msg = getmsg(115);
ShowErrorForCom("Frm_LRL","Fnt_LRL",msg);
return false;
}
else if(value6 == -3)
{
msg = getmsg(116,0,255);
ShowErrorForCom("Frm_LRL","Fnt_LRL",msg);
return false;
}
return true;
}
function ESSID_Choose()
{
setValue("IF_MEDIAINDEX", getValue("Frm_MEDIAIndex"));
DisableALL();
getObj("fSubmit").submit();
}
function pageLoad(url)
{
moveErrLayer(580,200);
getObj("fSubmit").action = url;
var errstr= getValue("IF_ERRORSTR");
var errpara = getValue("IF_ERRORPARAM");
ProcessRet(errstr, errpara);
pageGetValue();
}
function pageGetValue()
{
jslSetValue("Frm_MEDIAIndex","IF_MEDIAINDEX");
jslSetValue("Frm_AIFSN","AIFSN");
jslSetValue("Frm_ECWMin","ECWMin");
jslSetValue("Frm_ECWMax","ECWMax");
jslSetValue("Frm_TXOP","TXOP");
jslSetValue("Frm_Qlength","Qlength");
jslSetValue("Frm_SRL","SRL");
jslSetValue("Frm_LRL","LRL");
Wireless_switch();
}
function pageSetValue()
{
HiddenParaInit(MEDIA_PARA);
jslSetValue("AIFSN","Frm_AIFSN");
jslSetValue("ECWMin","Frm_ECWMin");
jslSetValue("ECWMax","Frm_ECWMax");
jslSetValue("TXOP","Frm_TXOP");
jslSetValue("Qlength","Frm_Qlength");
jslSetValue("SRL","Frm_SRL");
jslSetValue("LRL","Frm_LRL");
}
function pageSubmit()
{
ReSetValueRmZero("Frm_AIFSN","Frm_ECWMin","Frm_ECWMax","Frm_TXOP","Frm_Qlength","Frm_SRL","Frm_LRL");
if(pageCheckValue() == true)
{
jslDisable("Btn_Submit","Btn_Cancel");
pageSetValue();
setValue("IF_ACTION", "apply");
setValue("IF_CONFIGTAG", "Y");
setValue("IF_MEDIAINDEX", getValue("Frm_MEDIAIndex"));
DisableALL();
getObj("fSubmit").submit();
}
}
function pageCancel()
{
jslDisable("Btn_Submit","Btn_Cancel");
DisableALL();
getObj("fSubmit").submit();
}
</SCRIPT>
