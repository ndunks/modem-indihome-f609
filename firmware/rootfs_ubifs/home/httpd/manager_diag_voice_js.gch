
<script language="javascript" >
function getmsg(id)
{
var str      = new Array();
str[0]   = new Array(101, "&?error_101;");
str[1]   = new Array(100, "&?error_100;");
return getMsgFormArray(str, arguments);
}
function myDiagStart()
{
var DIAG_INSTNUM = getValue("IF_DIAG_INSTNUM");
if (DIAG_INSTNUM < 1)
{
getObj("Fnt_Msg").innerHTML = "&?diag008;";
return;
}
var DiagInterface_Identity = getValue("Frm_DiagInterface");
if (DIAG_INSTNUM >= 1 && DiagInterface_Identity == "")
{
msg = getmsg(100);
ShowErrorForCom("Frm_DiagInterface", "Fnt_DiagInterface", msg);
return;
}
setValue("IF_ACTION", "get");
setValue("IF_DIAG_IDENTITY", DiagInterface_Identity);
DisableALL();
getObj("fSubmit").submit();
}
function UpdateResult(id)
{
var val = getValue("IF_"+id);
if(val == "pass")
{
document.getElementById(id).setAttribute("class", "green");
document.getElementById(id).setAttribute("className", "green");
}
else if(val == "fail")
{
document.getElementById(id).setAttribute("class", "red");
document.getElementById(id).setAttribute("className", "red");
}
else
{
document.getElementById(id).setAttribute("class", "");
document.getElementById(id).setAttribute("className", "");
}
}
function pageLoad(url)
{
getObj("fSubmit").action = url;
var DIAG_INSTNUM = getValue("IF_DIAG_INSTNUM");
if ( DIAG_INSTNUM < 1)
{
getObj("Fnt_Msg").innerHTML = "&?diag008;";
return;
}
if( getValue("IF_ERRORSTR") == "&?cmret_260;")
{
var errstr= getValue("IF_ERRORSTR");
var errpara = getValue("IF_ERRORPARAM");
OldProcessRet(errstr, errpara);
moveErrLayer(570,4);
}
else
{
var DiagInterface_Identity = getValue("IF_DIAG_IDENTITY");
setValue("Frm_DiagInterface", DiagInterface_Identity);
UpdateResult("RegStatus");
}
}
</SCRIPT>
