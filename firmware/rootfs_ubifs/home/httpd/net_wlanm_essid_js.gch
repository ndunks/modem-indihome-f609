<script language="javascript">
var CONFIG_PARA = new Array(
"Enable",
"RadioStatus",
"Standard",
"BeaconInterval",
"RtsCts",
"Fragment",
"DTIM",
"TxPower",
"CountryCode",
"TxRate",
"Channel",
"ESSID",
"ESSIDPrefix",
"ACLPolicy",
"BeaconType",
"WEPAuthMode",
"WEPEncryptionLevel",
"WEPKeyIndex",
"WPAAuthMode",
"WPAEncryptType",
"WPAGroupRekey",
"WPAEAPServerIp",
"RadiusPort",
"RadiusServerPort",
"WPAEAPSecret",
"PossibleChannels",
"BasicDataRates",
"OpDataRates",
"PossibleTxRates",
"OOBAccessEnabled",
"BeaconEnabled",
"ESSIDHideEnable",
"RegulatoryDomain",
"WlanMode",
"DistanceFromRoot",
"PeerBSSID",
"AuthServiceMode",
"QosType",
"Priority",
"UAPSDEnabled",
"AutoChannelEnabled",
"ChannelsInUse",
"11iAuthMode",
"11iEncryptType",
"MaxUserNum",
"SSIDIsolationEnable",
"VapIsolationEnable"
);
function getmsg(id)
{
var str  = new Array();
str[0]   = new Array(101, "&?error_101;");
str[1]   = new Array(102, "&?error_102;");
str[2]   = new Array(103, "&?error_103;");
str[3]   = new Array(113, "&?error_113;");
str[4]   = new Array(118, "&?error_118;");
str[5]   = new Array(119, "&?error_119;");
str[6]   = new Array(122, "&?error_122;");
str[7]   = new Array(115, "&?error_115;");
str[8]   = new Array(116, "&?error_116;");
str[9]   = new Array(117, ".");
return getMsgFormArray(str, arguments);
}
function Wireless_switch()
{
if(getValue("RealRF") == "1")
{
if ( "0" == getValue("CardIsIn") )
{
setHTML("tipLi", "&?cwt024;");
jslEnDisplay("t_warn");
}
jslEnable("Frm_SSID_SET","Frm_ESSIDHideEnable","Frm_Enable",
"Frm_ESSID","Frm_Priority","Btn_Submit","Btn_Cancel",
"Frm_VapIsolationEnable","Frm_MaxUserNum");
ESSID_Enable();
}
else
{
setHTML("tipLi", "&?wlan079;");
jslEnDisplay("t_warn");
jslDisable("Frm_SSID_SET","Frm_ESSIDHideEnable","Frm_Enable",
"Frm_ESSID","Frm_Priority","Btn_Submit","Btn_Cancel",
"Frm_VapIsolationEnable","Frm_MaxUserNum");
}
}
function SubParaGetValue()
{
if(getValue("ESSIDHideEnable") == "1")
{
setChecked("Frm_ESSIDHideEnable", true);
}
else
{
setChecked("Frm_ESSIDHideEnable", false);
}
if(getValue("VapIsolationEnable") == "1")
{
setChecked("Frm_VapIsolationEnable", true);
}
else
{
setChecked("Frm_VapIsolationEnable", false);
}
jslSetValue("Frm_MaxUserNum","MaxUserNum");
jslSetValue("Frm_ESSID","ESSID");
if(getValue("Priority") == "")
{
setValue("Frm_Priority","0");
}
else
{
jslSetValue("Frm_Priority","Priority");
}
}
function ESSID_Enable()
{
if(getChecked("Frm_Enable")==false)
{
SubParaGetValue();
jslDisable("Frm_ESSIDHideEnable","Frm_ESSID","Frm_Priority","Frm_VapIsolationEnable","Frm_MaxUserNum");
}
else
{
jslEnable("Frm_ESSIDHideEnable","Frm_ESSID","Frm_Priority","Frm_VapIsolationEnable","Frm_MaxUserNum");
PageAttrInfo();
}
}
function checkNum(frm_id, fnt_id, isNull, minValue, maxValue)
{
var msg = "";
if( 0 == isNull && false == checkNull(getValue(frm_id)) )
{
return  true;
}
var numCheck = checkIntegerRange(getValue(frm_id), minValue, maxValue);
if("-1" == numCheck)
{
msg = getmsg(101);
ShowErrorForCom(frm_id, fnt_id, msg);
return false;
}
if("-2" == numCheck)
{
msg = getmsg(115);
ShowErrorForCom(frm_id, fnt_id, msg);
return false;
}
else
if("-3" == numCheck)
{
msg = getmsg(116, minValue, maxValue);
ShowErrorForCom(frm_id, fnt_id, msg);
return false;
}
return  true;
}
function ESSIDCheck()
{
var check;

if(getChecked("Frm_Enable")==false)
{
return true;
}
if(false == checkNum("Frm_MaxUserNum", "Fnt_MaxUserNum", 1, 1, 32))
{
return  false;
}

check = checkEssid(getValue("Frm_ESSID"));
if (check == -1)
{
msg = getmsg(101);
ShowErrorForCom("Frm_ESSID","Fnt_ESSID",msg);
return false;
}
if (check == -3)
{
msg = getmsg(102,1,32);
ShowErrorForCom("Frm_ESSID","Fnt_ESSID",msg);
return false;
}
if (check == false)
{
msg = getmsg(113);
ShowErrorForCom("Frm_ESSID","Fnt_ESSID",msg);
return false;
}
return true;
}
function AllCheck()
{
if (ESSIDCheck() == false)
return false;
return true;
}
function ESSID_Choose()
{
DisableALL();
location.href = getObj("fSubmit").action + "&IF_VIEWID=" + getValue("Frm_SSID_SET");
}
function pageLoad(url)
{
moveErrLayer(580,95);
getObj("fSubmit").action = url;
var errstr= getValue("IF_ERRORSTR");
var errpara = getValue("IF_ERRORPARAM");
ProcessRet(errstr, errpara);
pageGetValue();
}
function PageAttrInfo()
{
var essidname=getValue("Frm_SSID_SET");
var i = essidname.charAt(12);
var attr = getValue("IF_SSIDATTR"+i);
if(attr == "3")
{
jslDisable("Frm_ESSID");
}
else
{
jslEnable("Frm_ESSID");
}
}
function pageGetValue()
{
var instNum = getValue("WLAN_INSTNUM");
for (var i=0; i<instNum; i++)
{
var ident = getValue("WLAN_SSID"+i);
addSelectOption("Frm_SSID_SET", ident, "SSID"+ident.match(/\d+$/));
<%
if((getenv("CurrentVersionInfo") == 3) && (getenv("Right") == 2))
{
%>
i = instNum;
<%
}
%>
}
jslSetValue("Frm_SSID_SET","IF_VIEWID");
if(getValue("Enable") == "1")
{
setChecked("Frm_Enable", true);
}
else
{
setChecked("Frm_Enable", false);
}
SubParaGetValue();
Wireless_switch();
<%
var userright = getenv("Right");
var cver = getenv("CurrentVersionInfo");
%>
<%
if(cver == 74 && userright == 2)
{
%>
jslDiDisplay("TR_HideEnable","ssidenable","TR_VapEnable","TR_MaxUserNum","TR_Priority");
<%
}
%>
}
function pageSetValue()
{
HiddenParaInit(CONFIG_PARA);
if(getChecked("Frm_Enable") == true)
{
setValue("Enable", "1");
jslSetValue("ESSID","Frm_ESSID");
if(getChecked("Frm_ESSIDHideEnable") == true)
{
setValue("ESSIDHideEnable", "1");
}
else
{
setValue("ESSIDHideEnable", "0");
}
if(getChecked("Frm_VapIsolationEnable") == true)
{
setValue("VapIsolationEnable", "1");
}
else
{
setValue("VapIsolationEnable", "0");
}
jslSetValue("MaxUserNum","Frm_MaxUserNum");
}
else
{
setValue("Enable", "0");
}
jslSetValue("Priority","Frm_Priority");
}
function pageSubmit()
{
ReSetValueRmZero("Frm_MaxUserNum");
if(AllCheck() == true)
{
pageSetValue();
setValue("IF_ACTION", "apply");
setValue("IF_CONFIGTAG", "Y");
setValue("IF_VIEWID", getValue("Frm_SSID_SET"));
DisableALL();
getObj("fSubmit").submit();
}
}
function pageCancel()
{
DisableALL();
getObj("fSubmit").submit();
}
</SCRIPT>
