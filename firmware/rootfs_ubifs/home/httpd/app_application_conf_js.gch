<script language="javascript">
var APPLIST_PARA = new Array(
"ViewName",
"Enable",
"APPName",
"Catalog",
"Protocol",
"StartPort",
"EndPort",
"StartMapPort",
"EndMapPort"
);
var index ="";
var SourceAPPName_PARA = new Array();
var SourceAPPNameNum = 0;
function getSourceAPPName()
{
var num = getValue("IF_INSTNUM");
var SourceAPPName = "";
for( var i = 0; i < num; i++ )
{
var j = 0;
SourceAPPName = getValue("SourceAPPName" + i);
for( j = 0; j < SourceAPPNameNum; j++ )
{
if( SourceAPPName == SourceAPPName_PARA[j] )
{
break;
}
}
if( j == SourceAPPNameNum )
{
SourceAPPName_PARA[SourceAPPNameNum] = SourceAPPName;
SourceAPPNameNum++;
}
}
}
function pageLoad(url)
{
getObj("fSubmit").action = url;
var msg = "";
var errstr= getValue("IF_ERRORSTR");
var errpara = getValue("IF_ERRORPARAM");
OldProcessRet(errstr, errpara);
getSourceAPPName();
moveErrLayer(588,40);
pageGetValue();
}
function getNameValue(id, size, value)
{
return ("<input type=\"text\" class=\"uiNoBorder\" size=\""
+ size +"\" value=\""
+ HTMLEnCode(value) + "\"  id=\"" + id + "\"  readonly>");
}
function addline(index)
{
var newline  = getObj("ApplicationRule_Table").insertRow(-1);
var cellId = "";
var cellSize = 0;
var cellValue = "";
newline.setAttribute("class", "white");
newline.setAttribute("className", "white");
for(var i = 0; i < 5 ; i++)
{
cellId = "Line_" + APPLIST_PARA[i+4] + index;
cellValue = getValue(APPLIST_PARA[i+4]+index);
cellSize  = 10;
if((0 != i) && parseInt(cellValue) == -1)
{
cellValue = "";
}
if(0 == i)
{
cellValue = TransferList(cellValue);
}
if(1 == i && cellValue == 0)
{
cellValue = "1";
}
if(2 == i)
{
if(getValue("StartPort"+index) == "0")
{
cellValue = "65535"
}
else
{
if(cellValue == "0")
{
cellValue = getValue("StartPort"+index);
}
}
}
if(3 == i && getValue("StartPort"+index) == 0)
{
cellValue = "1";
}
if(4 == i)
{
if(getValue("StartPort"+index) == "0")
{
cellValue = "65535"
}
else
{
if(cellValue == "0")
{
cellValue = getValue("StartMapPort"+index);
}
}
}
newline.insertCell(-1).innerHTML = getNameValue(cellId, cellSize, "");
setValue(cellId, cellValue);
}
newCell = newline.insertCell(-1);
newCell.innerHTML = getImagefrmClass("multiImg_modify", "Modify("+index+")",
"modify" + index);
newCell.id = "modify_" + (index).toString();
newCell = newline.insertCell(-1);
newCell.innerHTML = getImagefrmClass("multiImg_delete", "Delete("+index+")",
"delete" + index);
newCell.id = "delete_" + (index).toString();
}
function TransferList(para_i)
{
if(0 == para_i)
{
return "TCP";
}
else if(1 == para_i)
{
return "UDP";
}
else if(2 == para_i)
{
return "TCP AND UDP";
}
return  null;
}
function showTable()
{
var num   = getValue("IF_APPNAMEINST");
if( num > 0)
{
jslDisable("Frm_APPName");
jslEnDisplay("Btn_NameModify");
jslDiDisplay("Btn_NameSave");
for(var i = 0; i < num; i++)
{
index = getValue("IF_INSTID" + i);
addline(index);
}
}
else
{
jslDiDisplay("Btn_NameModify");
jslEnDisplay("Btn_NameSave");
var newline = getObj("ApplicationRule_Table").insertRow(-1);
newline.setAttribute("align", "center");
newline.setAttribute("class", "white");
newline.setAttribute("className", "white");
var objcell =  newline.insertCell(-1);
objcell.colSpan = 7;
objcell.innerHTML= "&?note_007;";
}
}
function getmsg(id)
{
var str      = new Array();
str[0]   = new Array(101, "&?error_101;");
str[1]   = new Array(102, "&?error_102;");
str[2]   = new Array(103, "&?error_103;");
str[3]   = new Array(108, "&?error_108;");
str[4]   = new Array(115, "&?error_115;");
str[5]   = new Array(116, "&?error_116;");
str[6]   = new Array(117, "&?error_117;");
str[7]   = new Array(118, "&?error_118;");
str[8]   = new Array(119, "&?error_119;");
str[9]   = new Array(122, "&?error_122;");
str[10]  = new Array(139, "&?error_139;");
str[11]  = new Array(140, "&?error_140;");
str[12]  = new Array(144, "&?error_144;");
str[13]  = new Array(114, "&?error_114;");
str[14]  = new Array(192, "&?error_192;");
str[15]  = new Array(511, "&?error_511;");
str[16]  = new Array(193, "&?error_193;");
str[17]  = new Array(194, "&?error_194;");
str[18]  = new Array(195, "&?error_195;");
str[19]  = new Array(139, "&?error_139;");
str[20]  = new Array(140, "&?error_140;");
str[21]  = new Array(127, "&?error_127;");
return getMsgFormArray(str, arguments);
}
function setPort(postId, viewId)
{
if( "" == getValue(viewId) )
{
setValue(postId, "-1");
}
else
{
jslSetValue(postId, viewId);
}
}
function pageGetValue()
{
<%
var APPName = request("IF_APPName");
if(APPName IS NULL)
{
%>
setValue("Frm_APPName", "App1");
getObj("Frm_APPName").focus();
<%
}
else
{
%>
jslSetValue("Frm_APPName", "IF_APPName");
<%
}
%>
showTable();
}
function pageSetValue()
{
HiddenParaInit(APPLIST_PARA);
setPort("StartPort", "Frm_StartPort");
setPort("EndPort", "Frm_EndPort");
setPort("StartMapPort", "Frm_StartMapPort");
setPort("EndMapPort", "Frm_EndMapPort");
jslSetValue("Protocol", "Frm_Protocol");
setValue("vister", getValue("vister"));
var num   = getValue("IF_APPNAMEINST");
if( 0 == num)
{
jslSetValue("APPName", "Frm_APPName");
setValue("IF_APPName", getValue("Frm_APPName") );
}
else
{
jslSetValue("APPName", "IF_APPName");
setValue("IF_APPName", getValue("IF_APPName") );
}
}
function pageCheckValue(insId)
{
var msg = "";
var num = getValue("IF_APPNAMEINST");
if( num == 0 )
{
if(false == checkAPPName("Frm_APPName", "Fnt_APPName", 1, 1, 256))
{
return  false;
}
}
if(false == PageResetValueRmZero("Frm_StartPort","Fnt_StartPort"))
{
return  false;
}
if(false == PageResetValueRmZero("Frm_EndPort","Fnt_EndPort"))
{
return  false;
}
if(false == PageResetValueRmZero("Frm_StartMapPort","Fnt_StartMapPort"))
{
return  false;
}
if(false == PageResetValueRmZero("Frm_EndMapPort","Fnt_EndMapPort"))
{
return  false;
}
if(false == checkPort("Frm_StartPort", "Fnt_StartPort", 1, 1, 65535))
{
return  false;
}
if(false == checkPort("Frm_EndPort", "Fnt_EndPort", 1, 1, 65535))
{
return  false;
}
if( parseInt(getValue("Frm_StartPort")) != ""
&& parseInt(getValue("Frm_EndPort")) != "" )
{
if( parseInt(getValue("Frm_StartPort")) > parseInt(getValue("Frm_EndPort")) )
{
msg = getmsg(193);
ShowErrorForCom(null, null, msg);
return false;
}
}
if(false == checkPort("Frm_StartMapPort", "Fnt_StartMapPort", 1, 1, 65535))
{
return  false;
}
if(false == checkPort("Frm_EndMapPort", "Fnt_EndMapPort", 1, 1, 65535))
{
return  false;
}
if( ( parseInt(getValue("Frm_StartPort")) + parseInt(getValue("Frm_EndPort")) + parseInt(getValue("Frm_StartMapPort")) + parseInt(getValue("Frm_EndMapPort")) != 0 )
&& ( parseInt(getValue("Frm_StartPort")) * parseInt(getValue("Frm_EndPort")) * parseInt(getValue("Frm_StartMapPort")) * parseInt(getValue("Frm_EndMapPort")) == 0 )
)
{
msg = getmsg(192);
ShowErrorForCom("Frm_StartPort", null, msg);
return  false;
}
if( parseInt(getValue("Frm_StartMapPort")) != ""
&& parseInt(getValue("Frm_EndMapPort")) != "" )
{
if( parseInt(getValue("Frm_StartMapPort")) > parseInt(getValue("Frm_EndMapPort")) )
{
msg = getmsg(194);
ShowErrorForCom(null, null, msg);
return false;
}
}
if((parseInt(getValue("Frm_EndMapPort")) - parseInt(getValue("Frm_StartMapPort")))!=(parseInt(getValue("Frm_EndPort")) - parseInt(getValue("Frm_StartPort"))))
{
msg = getmsg(195);
ShowErrorForCom(null, null, msg);
return false;
}
return true;
}
function PageResetValueRmZero(frm_id, fnt_id)
{
if( false == ReSetValueRmZero(frm_id) )
{
var msg = getmsg(144);
ShowErrorForCom(frm_id, fnt_id, msg);
return false;
}
return true;
}
function checkName(frm_id, fnt_id, isNull, minLength, maxLength)
{
var msg = "";
if( 0 == isNull && false == checkNull(getValue(frm_id)) )
{
return true;
}
var  nameCheck = checkStrLengthRange(getValue(frm_id), minLength, maxLength);
if("-1" == nameCheck)
{
msg = getmsg(101);
ShowErrorForCom(frm_id, fnt_id, msg);
return false;
}
else if(false == checkAPPNameForASC(getValue(frm_id)))
{
msg = getmsg(114);
ShowErrorForCom(frm_id, fnt_id, msg);
return false;
}
if("-3" == nameCheck)
{
msg = getmsg(102, minLength, maxLength);
ShowErrorForCom(frm_id, fnt_id, msg);
return false;
}
return true;
}
function checkAPPNameForASC(value)
{
var length = value.length;
for(var j = 0 ;j < length; j++)
{
var xx = value.charCodeAt(j);
if (xx >= 32 && xx <= 126 )
{
}
else
{
return false;
}
}
return true;
}
function checkAPPName(frm_id, fnt_id, isNull, minLength, maxLength)
{
var IF_APPName  = getValue("IF_APPName");
var Frm_APPName = getValue("Frm_APPName");
if( false == checkName(frm_id, fnt_id, isNull, minLength, maxLength) )
{
return false;
}
if( Frm_APPName != IF_APPName )
{
for(var i = 0; i < SourceAPPNameNum; i++ )
{
if( Frm_APPName == SourceAPPName_PARA[i])
{
var msg = "";
var num = getValue("IF_APPNAMEINST");
if( 0 == num )
{
msg = getmsg(139);
}
else
{
msg = getmsg(140);
}
ShowErrorForCom("Frm_APPName", "", msg);
return false;
}
}
}
}
function checkPort(frm_id, fnt_id, isNull, minValue, maxValue)
{
var msg = "";
if( 0 == isNull && false == checkNull(getValue(frm_id)) )
{
return true;
}
var portCheck = checkIntegerRange(getValue(frm_id), minValue, maxValue);
if("-1" == portCheck)
{
msg = getmsg(101);
ShowErrorForCom(frm_id, fnt_id, msg);
return false;
}
if("-2" == portCheck)
{
msg = getmsg(115);
ShowErrorForCom(frm_id, fnt_id, msg);
return false;
}
else if("-3" == portCheck)
{
msg = getmsg(116, minValue, maxValue);
ShowErrorForCom(frm_id, fnt_id, msg);
return false;
}
return true;
}
function pageAdd()
{
jslEnDisplay("Btn_Add");
jslDiDisplay("Btn_Edit");
if(true == pageCheckValue(-1))
{
pageSetValue();
setValue("IF_ACTION", "new");
setValue("IF_INDEX", "-1");
DisableALL();
getObj("fSubmit").submit();
}
else
{
}
}
function pageEdit()
{
if(true == pageCheckValue(index))
{
pageSetValue();
setValue("IF_ACTION", "apply");
setValue("IF_INDEX", index);
DisableALL();
getObj("fSubmit").submit();
}
else
{
}
}
function showPort(viewId, postId)
{
if(parseInt(getValue(postId)) == -1)
{
setValue(viewId, "");
}
else
{
jslSetValue(viewId, postId);
}
}
function Modify(i)
{
jslDiDisplay("Btn_Add");
jslEnDisplay("Btn_Edit");
document.getElementById("back").style.display="";
ModifyGetValue(i);
index = i;
}
function ModifyGetValue(i)
{
var prtcObj = getObj("Frm_Protocol");
jslDoShowComboBox("Frm_Protocol", "Protocol"+i);
if(-1 == prtcObj.selectedIndex)
{
setSelOtherValue(prtcObj, "", null);
prtcObj.selectedIndex = 0;
}
showPort("Frm_StartPort", "StartPort"+i);
showPort("Frm_EndPort", "EndPort"+i);
showPort("Frm_StartMapPort", "StartMapPort"+i);
showPort("Frm_EndMapPort", "EndMapPort"+i);
if (getValue("StartPort"+i) == "0")
{
setValue("Frm_StartPort", "1");
setValue("Frm_EndPort", "65535");
setValue("Frm_StartMapPort", "1");
setValue("Frm_EndMapPort", "65535");
}
if(getValue("StartPort"+i) != "0" && getValue("EndPort"+i) == "0")
{
jslSetValue("Frm_EndPort", "StartPort"+i);
}
if(getValue("StartPort"+i) != "0" && getValue("EndMapPort"+i) == "0")
{
jslSetValue("Frm_EndMapPort", "StartMapPort"+i);
}
}
function Delete(i)
{
setValue("IF_ACTION", "delete");
setValue("IF_INDEX",i);
setValue("vister", getValue("vister"));
setValue("IF_APPName", getValue("IF_APPName") );
DisableALL();
getObj("fSubmit").submit();
}
function pageBack()
{
<%
var vister = "";
vister = encodeURL(raw_request("vister"));
%>
setValue("IF_APPName", "");
getObj("fSubmit").action = getURL("<%=vister;%>");
DisableALL();
getObj("fSubmit").submit();
}
function APPNameSave()
{
var num  = getValue("IF_APPNAMEINST");
if( false == checkAPPName("Frm_APPName", "Fnt_APPName", 1, 1, 256) )
{
return;
}
jslDisable("Frm_APPName");
jslEnDisplay("Btn_NameModify");
jslDiDisplay("Btn_NameSave");
if(0 == num )
{
}
else
{
setValue("IF_PREVAPPName", getValue("IF_APPName") );
jslSetValue("APPName", "Frm_APPName");
setValue("IF_APPName", getValue("Frm_APPName") );
setValue("IF_ACTION", "modifyName");
DisableALL();
getObj("fSubmit").submit();
}
}
function APPNameEdit()
{
jslEnable("Frm_APPName");
jslDiDisplay("Btn_NameModify");
jslEnDisplay("Btn_NameSave");
}
function back4add()
{
var number = getValue("IF_APPNAMEINST");
DisableALL();
getObj("fSubmit").submit();
}
</script>
